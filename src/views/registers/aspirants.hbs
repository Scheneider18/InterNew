<div class="header-actividad">
    <div class="titulo">
        <h2>
            <b>Aspirantes</b>
        </h2>
    </div>
</div>


<div class="container-fluid">
    <div class="mt-3">
        <div class="table-responsive text-center">
            <table class="table table-bordered table-hover align-middle table-scroll" data-mdb-perfect-scrollbar="true"
                style="position: relative; height: auto;">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">Número de Control</th>
                        <th scope="col">Foto</th>
                        <th scope="col">Nombre Completo</th>
                        <th scope="col">Registro</th>
                        <th scope="col">Estado</th>
                    </tr>
                </thead>
                {{#each registers}}
                <tbody class="table-light">
                    <tr>
                        <td>
                            {{no_control}}
                        </td>
                        <td>
                            <img src="../../img/profile.jpeg" alt="Usuario" class="rounded-circle p-1" width="70">
                        </td>
                        <td>{{nombre}} {{apellido_p}} {{apellido_m}}</td>
                        <td>
                            <a href="/registers/view/register/{{id_reg}}/{{no_control}}" class="btn btn-primary btn-sm px-3"><i
                                    class="fas fa-eye"></i></a>
                        <td>
                            <button onclick="aceptar({{id_reg}},'{{no_control}}')" class="btn btn-success">
                                <i class="fas fa-check"></i>
                                Aceptar
                            </button>
                            <button onclick="rechazar({{id_reg}},'{{no_control}}')" class="btn btn-danger">
                                Rechazar
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
                {{/each}}
                {{#each registers2}}
                <tbody class="table-light">
                    <tr>
                        <td>
                            {{no_control}}
                        </td>
                        <td>
                            <img src="../../img/profile.jpeg" alt="Usuario" class="rounded-circle p-1" width="70">
                        </td>
                        <td>{{nombre}} {{apellido_p}} {{apellido_m}}</td>
                        <td>
                            <a href="/registers/view/register/{{id_reg}}/{{no_control}}" class="btn btn-primary btn-sm px-3"><i
                                    class="fas fa-eye"></i></a>
                        <td>
                            <button onclick="aceptar({{id_reg}},'{{no_control}}')" class="btn btn-success">
                                <i class="fas fa-check"></i>
                                Aceptar
                            </button>
                            <button onclick="rechazar({{id_reg}},'{{no_control}}')" class="btn btn-danger">
                                Rechazar
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
                {{/each}}
            </table>
        </div>
    </div>
    <div class="contenedor-back">
        <a href="javascript: history.go(-1)" class="btn btn-danger">
            Regresar
            <i class="fas fa-arrow-left"></i>
        </a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.0.2/dist/sweetalert2.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    function aceptar(id, no_control) {
        let url = "/registers/accepted/add/";
        Swal.fire({
            title: '¿Estás seguro de que desea aceptar al usuario?',
            showCancelButton: true,
            confirmButtonText: 'Confirmar',
            cancelButtonText: 'Cancelar',
        }).then((result) => {
            if (result.isConfirmed) {
                //procedimiento borrar
                axios.post(url + id + '/' + no_control).then((response) => {
                    this.mostrar();
                    location.reload();
                });
                //Swal.fire('¡Eliminado!', '', 'success')
            } else if (result.isDenied) {
            }
        });
    }

    function mostrar() {
        let url = "/registers/participants1";
        return axios.get(url);
    }

    function rechazar(id, no_control) {
        let url = "/registers/rejected/add/";
        Swal.fire({
            title: '¿Estás seguro de que deseas rechazar al usuario?',
            showCancelButton: true,
            confirmButtonText: 'Confirmar',
            cancelButtonText: 'Cancelar',
        }).then((result) => {
            if (result.isConfirmed) {
                //procedimiento borrar
                axios.post(url + id + '/' + no_control).then((response) => {
                    this.mostrar();
                    location.reload();
                });
                //Swal.fire('¡Eliminado!', '', 'success')
            } else if (result.isDenied) {
            }
        });
    };

</script>